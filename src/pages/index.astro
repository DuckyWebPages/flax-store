---
import BaseLayout from "../layouts/BaseLayout.astro";
import AddToCart from "../components/AddToCart.astro";
<AddToCart {...item} />


import { products } from "../data/products";

const title = "Flax Lignan Health — Shop";
---
<BaseLayout>
  <main>
    <style>
      :root {{ color-scheme: light; }}
      body {{ background:#f8fafc; color:#0f172a; }}
      main {{ max-width: 1100px; margin: 0 auto; padding: 24px 16px 56px; }}
      .muted {{ font-size:12px; color:#64748b; }}
      h1 {{ margin: 0 0 8px; }}
      .grid {{ display: grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr)); gap: 16px; }}
      .card {{ background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:14px; box-shadow: 0 1px 2px rgba(0,0,0,0.04); display:flex; flex-direction:column; }}
      .img {{ width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:10px; background:#f1f5f9; }}
      .title {{ font-weight:700; margin:10px 0 4px; }}
      .desc {{ font-size:14px; color:#475569; }}
      .row {{ display:flex; align-items:center; justify-content:space-between; margin-top:10px; gap:10px; }}
      .price {{ font-weight:800; }}
      .btns {{ display:flex; gap:8px; align-items:center; }}
      .buyNow {{ background:#000; color:#fff; padding:8px 12px; border-radius:8px; font-size:14px; text-decoration:none; white-space:nowrap; }}
    </style>

    <h1>Flax Lignan Health</h1>
    <p class="muted">Fast, static shop. Payments handled by Stripe.</p>

    <h2 id="products">Products</h2>
    <div class="grid">
      {products.map((p) => {
        // Convert your price (number) to cents for the cart
        const unitCents = Math.round((p.price ?? 0) * 100);
        const item = {
          id: p.id ?? p.slug ?? p.name.toLowerCase().replace(/\s+/g, "-"),
          name: p.name,
          unitCents,
          image: p.image,
          // priceId (Stripe) can be added here later if you want
        };
        return (
          <article class="card">
            <img class="img" src={p.image} alt={p.name} loading="lazy" />
            <div class="title">{p.name}</div>
            <div class="desc">{p.description}</div>
            <div class="row">
              <div class="price">${(p.price ?? 0).toFixed(2)}</div>
              <div class="btns">
                {/* Add to Cart (opens drawer) */}
                <AddToCart client:load {...item} />

                {/* Optional: keep your existing direct Stripe Payment Link if present */}
                {p.stripePaymentLink && (
                  <a class="buyNow" href={p.stripePaymentLink} rel="noopener noreferrer">
                    Buy Now
                  </a>
                )}
              </div>
            </div>
          </article>
        );
      })}
    </div>

    <footer style="max-width:1100px;margin:24px auto 0;padding:16px;">
      © {new Date().getFullYear()} Flax Lignan Health
    </footer>
  </main>
</BaseLayout>
