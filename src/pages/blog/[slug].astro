---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export const prerender = true;

export async function getStaticPaths() {
  const posts = await getCollection('posts', ({ data }) => !data.draft);
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post }
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
const title = `${post.data.title} — Flax Lignan Health`;
---

<BaseLayout>
  <article class="post">
    <header class="post-header">
      <h1>{post.data.title}</h1>
      <p class="meta">
        {post.data.date.toLocaleDateString('en-US', { year:'numeric', month:'long', day:'numeric' })}
        {post.data.tags?.length ? ` • ${post.data.tags.join(', ')}` : ''}
      </p>
      {post.data.heroImage && <img class="hero" src={post.data.heroImage} alt="" />}
    </header>

    <main class="post-body">
      <Content />
    </main>

    <footer class="post-footer">
      <a href="/blog/">← Back to Blog</a>
    </footer>
  </article>

  <style>
    .post { max-width: 820px; margin: 1.5rem auto 3rem; padding: 0 1rem; }
    .post-header h1 { font-weight: 700; font-size: clamp(2rem, 4.6vw, 2.8rem); margin: 0 0 .25rem; }
    .meta { color:#555; margin: 0 0 .75rem; }
    .hero { width: 100%; display: block; border-radius: 12px; margin: .5rem 0 1rem; }
    .post-body :where(p, li) { line-height: 1.7; }
    .post-footer { margin-top: 2rem; }
  </style>
</BaseLayout>
